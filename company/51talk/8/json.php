<?php
$re = '{
    "2016-04-04": {
        "total": 1075,
        "pay": "64",
        "nopay": 1011
    },
    "2016-04-11": {
        "total": 1790,
        "pay": "81",
        "nopay": 1709,
        "last": {
            "2016-04-04": {
                "lastcount": 753,
                "lastpay": 113,
                "lastnopay": 640
            }
        }
    },
    "2016-04-18": {
        "total": 4419,
        "pay": "80",
        "nopay": 4339,
        "last": {
            "2016-04-04": {
                "lastcount": 662,
                "lastpay": 129,
                "lastnopay": 533
            },
            "2016-04-11": {
                "lastcount": 1388,
                "lastpay": 140,
                "lastnopay": 1248
            }
        }
    },
    "2016-04-25": {
        "total": 5184,
        "pay": "144",
        "nopay": 5040,
        "last": {
            "2016-04-04": {
                "lastcount": 489,
                "lastpay": 115,
                "lastnopay": 374
            },
            "2016-04-11": {
                "lastcount": 1023,
                "lastpay": 120,
                "lastnopay": 903
            },
            "2016-04-18": {
                "lastcount": 3367,
                "lastpay": 243,
                "lastnopay": 3124
            }
        }
    },
    "2016-05-02": {
        "total": 3636,
        "pay": "36",
        "nopay": 3600,
        "last": {
            "2016-04-04": {
                "lastcount": 482,
                "lastpay": 129,
                "lastnopay": 353
            },
            "2016-04-11": {
                "lastcount": 944,
                "lastpay": 168,
                "lastnopay": 776
            },
            "2016-04-18": {
                "lastcount": 2793,
                "lastpay": 325,
                "lastnopay": 2468
            },
            "2016-04-25": {
                "lastcount": 3821,
                "lastpay": 340,
                "lastnopay": 3481
            }
        }
    },
    "2016-05-09": {
        "total": 3898,
        "pay": "79",
        "nopay": 3819,
        "last": {
            "2016-04-04": {
                "lastcount": 476,
                "lastpay": 136,
                "lastnopay": 340
            },
            "2016-04-11": {
                "lastcount": 856,
                "lastpay": 166,
                "lastnopay": 690
            },
            "2016-04-18": {
                "lastcount": 2409,
                "lastpay": 353,
                "lastnopay": 2056
            },
            "2016-04-25": {
                "lastcount": 3205,
                "lastpay": 437,
                "lastnopay": 2768
            },
            "2016-05-02": {
                "lastcount": 2754,
                "lastpay": 156,
                "lastnopay": 2598
            }
        }
    },
    "2016-05-16": {
        "total": 11225,
        "pay": "77",
        "nopay": 11148,
        "last": {
            "2016-04-04": {
                "lastcount": 422,
                "lastpay": 135,
                "lastnopay": 287
            },
            "2016-04-11": {
                "lastcount": 859,
                "lastpay": 168,
                "lastnopay": 691
            },
            "2016-04-18": {
                "lastcount": 2227,
                "lastpay": 353,
                "lastnopay": 1874
            },
            "2016-04-25": {
                "lastcount": 2818,
                "lastpay": 469,
                "lastnopay": 2349
            },
            "2016-05-02": {
                "lastcount": 1982,
                "lastpay": 192,
                "lastnopay": 1790
            },
            "2016-05-09": {
                "lastcount": 2907,
                "lastpay": 175,
                "lastnopay": 2732
            }
        }
    },
    "2016-05-23": {
        "total": 8249,
        "pay": "61",
        "nopay": 8188,
        "last": {
            "2016-04-04": {
                "lastcount": 419,
                "lastpay": 131,
                "lastnopay": 288
            },
            "2016-04-11": {
                "lastcount": 781,
                "lastpay": 167,
                "lastnopay": 614
            },
            "2016-04-18": {
                "lastcount": 2014,
                "lastpay": 354,
                "lastnopay": 1660
            },
            "2016-04-25": {
                "lastcount": 2502,
                "lastpay": 474,
                "lastnopay": 2028
            },
            "2016-05-02": {
                "lastcount": 1673,
                "lastpay": 211,
                "lastnopay": 1462
            },
            "2016-05-09": {
                "lastcount": 2285,
                "lastpay": 263,
                "lastnopay": 2022
            },
            "2016-05-16": {
                "lastcount": 8086,
                "lastpay": 310,
                "lastnopay": 7776
            }
        }
    },
    "2016-05-30": {
        "total": 4365,
        "pay": "23",
        "nopay": 4342,
        "last": {
            "2016-04-04": {
                "lastcount": 370,
                "lastpay": 124,
                "lastnopay": 246
            },
            "2016-04-11": {
                "lastcount": 683,
                "lastpay": 163,
                "lastnopay": 520
            },
            "2016-04-18": {
                "lastcount": 1798,
                "lastpay": 344,
                "lastnopay": 1454
            },
            "2016-04-25": {
                "lastcount": 2043,
                "lastpay": 441,
                "lastnopay": 1602
            },
            "2016-05-02": {
                "lastcount": 1419,
                "lastpay": 202,
                "lastnopay": 1217
            },
            "2016-05-09": {
                "lastcount": 1850,
                "lastpay": 284,
                "lastnopay": 1566
            },
            "2016-05-16": {
                "lastcount": 6690,
                "lastpay": 331,
                "lastnopay": 6359
            },
            "2016-05-23": {
                "lastcount": 5928,
                "lastpay": 152,
                "lastnopay": 5776
            }
        }
    }
}';
$arr = json_decode($re, true);
?>
<style>
    table {
        border-collapse:collapse;
    }
    td{
        padding: 5px;
        border: 1px solid gray;
    }
</style>
<table>
    <tr>
        <td>&nbsp;&nbsp;</td>
        <?php foreach ($arr as $date => $row) { ?>
            <td colspan="3"><?php echo $date; ?></td>
        <?php } ?>
    </tr>
    <tr>
        <td>&nbsp;&nbsp;</td>
        <?php foreach ($arr as $date => $row) { ?>
            <td>总量</td>
            <td>付费</td>
            <td>未付费</td>
        <?php } ?>
    </tr>

    <?php foreach ($arr as $date => $row) { //行?>
        <tr>
            <td><?php echo $date; ?></td>
            <?php foreach ($arr as $date1 => $row1) { //列?>
                <?php if ($date == $date1) { ?>
                    <td><?php echo $row['total']; ?></td>
                    <td><?php echo $row['pay']; ?></td>
                    <td><?php echo $row['nopay']; ?></td>
                <?php } else { ?>
                    <?php
                    if (isset($row1['last'][$date])) {
                        ?>
                        <td><?php echo $row1['last'][$date]['lastcount']; ?></td>
                        <td><?php echo $row1['last'][$date]['lastpay']; ?></td>
                        <td><?php echo $row1['last'][$date]['lastnopay']; ?></td>
                    <?php } else { ?>
                        <td>&nbsp;&nbsp;</td>
                        <td>&nbsp;&nbsp;</td>
                        <td>&nbsp;&nbsp;</td>
                    <?php } ?>
                <?php } ?>
            <?php } ?>
        </tr>
    <?php } ?>

</table>